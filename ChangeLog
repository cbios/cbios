$Id: ChangeLog,v 1.124 2005/05/16 23:24:23 mthuurne Exp $

2005-05-17 Albert Beevendorp
    * Added V9938 version of the logo
      - moved some portions of the TMS99x8 logo from main.asm to logo.asm
      - made prn_text in main.asm multi-screenmode ready
      - fixed a bug in grpprt_sub in sub.asm
      - main texts are printed in both pattern mode and graphical mode
      - TODO: get rid of the "Cartridge found in slot: 3.3" when there is
        no cart inserted in graphical mode.

2005-05-16 Maarten ter Huurne <maarten@treewalker.org>
    * Committed RuMSX configs with some fixes from Rudolf Lechleitner.
    * Reset vertical scroll register in CHGMOD.
      Fixes problem in "The Cockpit" when you start the game before the title
      scroll is finished.
    * Refactored code for setting the number of lines (192/212) and for turning
      off page blinking: now this code is always executed on V9938/58, even for
      MSX1 modes.

2005-05-16 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Rewrote the cartridge search code.
      It isn't finished yet and may break things, please test.

2005-03-26 Albert Beevendorp
    * Reset initial HIMEM value to $F380.
      Fixes Young Sherlock. The disk ROM should alter HIMEM itself

2005-03-19 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Disable interrupts around VRAM writes.
      Fixes intro screen in `Zaider - Battle of Peguss'.

2005-02-24 BouKiCHi
    * calslt_restore(some rouines uses it) routine returns with EI
    * rewritten make.bat and build.bat

2005-02-19 Maarten ter Huurne <maarten@treewalker.org>
    * Select RAM in page 2 already on first boot attempt.
      Fixes one particular variant of Boulder Dash.

2005-02-15 BouKiCHi
    * Translate main.asm to English

2005-02-14 Albert Beevendorp / BouKiCHi
    * implemented code to boot games in PAGE0.
      Thank you, BouKiCHi

2005-02-09 Maarten ter Huurne <maarten@treewalker.org>
    * Released C-BIOS 0.20.

2005-02-06 Maarten ter Huurne <maarten@treewalker.org>
    * Call FILVRM instead of BIGFIL on MSX1 in CLRSPR.
      Fixes sprites of The Fantasm Soldier Valis on MSX1.
    * Wait until VDP command is done before returning from CLS.

2005-02-06 Albert Beevendorp
    * added some more version specific compilation
    * moved the font to the default address if $1BBF as games depend
      on it being there
    * removed font from subrom

2005-02-05 Maarten ter Huurne <maarten@treewalker.org>
    * Workaround for buggy cartridge boot code: HALT just before calling
      the cart, so it will have a long time before the first interrupt.
      Fixes hang of Koronis Rift.
    * Rewrite VDP control registers in CHGMOD.
      Fixes title screen garbage sprites of Hole in One Special.
    * Corrected the value written to the VDP regs for sprite attribute and
      pattern base addresses in SCREEN 7 and 8.

2005-01-20 Albert Beevendorp
    * moved logo plot code from main.asm to logo.asm
      enables easy implementation of adjusted logo's for
      MSX1, MSX2 and MSX2+
    * replaced the logo by one made by Eric Boon
    * added initialization for CGPNT
    * fixed GRPPRT in the subrom, mainrom still needs implementation
      preparing for MSX2 and MSX2+ boot screens

2005-01-15 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Implemented GETVCP and GETVC2.

2005-01-14 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Fixed init_sc4 to set the sprite pattern base address correctly.

2005-01-13 Albert Beevendorp
    * moved slot routines to seperate source: slot.asm
      routines are used by both main and sub rom
    * made GETPAT fully functional now in both main and sub rom
    * implemented handler for maskable interrupt to sub rom
      fixes slowdowns with BLTVM
    * cleaned up subrom detection source and BLTVM source
    * CLRSPR now calls NSETWR on MSX2 and SETWRT on MSX1
      fixes a few games with garbled lines

2005-01-11 Maarten ter Huurne <maarten@treewalker.org>
    * Rewrote key buffering code:
      - it uses a ring buffer now (more efficient, more like MSX BIOS)
      - made sure the new buffering code is harmless when interacting with
        a bug in Ashguine 2
      - KILBUF only empties buffer; it does not mess with NEWKEY and OLDKEY
        (this fixes some issues we misdiagnosed as too fast key repeat)

2005-01-10 Maarten ter Huurne <maarten@treewalker.org>
    * Fixed sub ROM version of CLS.
      T&E logo of Ashguine 2 is now shown on a black background.

2005-01-09 Albert Beevendorp
    * fixed BLTVM. It wasn't tested yet as games using it were unknown
      at that time.
    * sped up BLTVM. Fixes issues with several games that were broken with
      the previous.

2005-01-08 Maarten ter Huurne <maarten@treewalker.org>
    * Added support for loading to page 1.
    * Initialise F341-F344 (RAM slot for each page).
    * Initialise DRVINF table.
    * Partial implementation of DSKRST and CURDRV BDOS functions.
    * Partial implementation of CONOUT BDOS function.
    * Implemented STROUT BDOS function.
    * Implemented VERIFY BDOS function by doing nothing: according to the DOS2
      docs, the verify feature is optional, so we just ignore the verify flag.

2005-01-08 Albert Beevendorp
    * turned a few relative jumps into absolute jumps in CHPUT to fix
      compilation errors

2005-01-08 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Implemented control codes in CHPUT.
    * Implemented ESC-B, ESC-C and ESC-D (cursor down, right and left) in
      CHPUT.
    * Implemented ESC-E, ESC-j and ESC-H (clear screen and cursor home).
    * Implemented ESC-K, ESC-J and ESC-l (erase to end of line, erase to end
      of screen and erase line).
    * Rewrote character output part of CHPUT.

2005-01-07 Maarten ter Huurne <maarten@treewalker.org>
    * First implementation steps towards a disk ROM.
      Uses a disk image appended to the ROM, placed in a Konami4 mapper.
      Succesfully reads the boot sector, but not much else.

2005-01-07 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Added stubs for control and escape codes in CHPUT.

2005-01-06 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Implemented INIMLT and SETMLT.
    * Implemented CLS for SCREEN 3.

2005-01-05 Albert Beevendorp
    * Added GRPPRT, GETPAT
    * Added RST calls to subrom
    * Added simple CHRGTR to subrom
    * Added DOCOMPR to subrom

2005-01-05 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Rewrote adr_sft, renamed to set_base_address.
    * Fixed SETTXT to set the base address registers correctly.
    * Modified SETT32, SETGRP and init_sc4 to use set_base_address.
    * Disable screen at the start of initialization routines.

2005-01-04 Albert Beevendorp
    * Fixed TOTEXT
    * Added CHGCAP
    * Added STMOTR
    * Added BLTMV

2005-01-04 Maarten ter Huurne <maarten@treewalker.org>
    * Recognise escape sequences in CHPUT.
      This eliminates the garbage printed on DOS prompts.
      Note that the escape sequences are all ignored at the moment.
    * Implemented ESC-A (cursor up) in CHPUT.
    * Fixed POSIT: row and column were swapped.
    * Implemented BREAKX.

2005-01-03 Albert Beevendorp
    * Added conditional compilation for subrom search
    * Completed GTSTCK direction tables
    * Added VDP dependent compilation for LDIRMV, LDIRVM, CHGMOD, INITXT,
      INIT32, INIGRP and CLS
    * Removed the init from the music ROM

2005-01-03 Maarten ter Huurne <maarten@treewalker.org>
    * Implemented SCREEN0 in 80 columns mode (TEXT2).
    * Implemented centering if WIDTH is less than maximum allowed by the VDP.
    * Rewrote curs2de, renamed to curs2hl.
    * Rewrote VRAM copy part of text scrolling routine.

2005-01-03 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Fixed a text scrolling bug in CHPUT.

2005-01-02 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Added stubs for `Graphic routines'. All MSX1 BIOS routines are now
      either implemented or stubbed.

2005-01-02 Joost Yervante Damad <joost@lumatec.be>
    * model dependant romid in main.asm

2005-01-02 Albert Beevendorp
    * adjusted make.bat to compile the version dependent ROMs
    * updated blueMSX, NLMSX and RuMSX configurations

2005-01-02 Patrick van Arkel <cbios@vampier.net>
    * Came up with an initial plan to auto make configs for different emu's

2005-01-01 Maarten ter Huurne <maarten@treewalker.org>
    * Create different ROMs for MSX1, MSX2 and MSX2+.
    * Added openMSX configuration for MSX2+ (thanks to Manuel).

2005-01-01 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Added stubs for some missing entries in main.asm.

2004-12-31 Albert Beevendorp
    * Reset DPPAGE and ACPAGE on every CHGMOD
      Fixes graphical bug in A-Class Mahjong
    * CLS on bitmap screens now uses HMMV
    * Added necessary code to SETRD and SETWRT for V99x8
    * Fixed FILVRM to use 16-bits range for some reason
      Fixes Contra graphical glitches

2004-12-30 Maarten ter Huurne <maarten@treewalker.org>
    * Fixed dependency checking: it now checks dependencies recursively,
      so includes from included sources are checked properly.
    * Fixed boot sequence: Konami games which use disk saves work again
      (they were broken by the hacks to make the NMS8250 disk ROM boot).

2004-12-30 Joost Yervante Damad <joost@lumatec.be>
    * fix inconsistent naming
    * replace calls to dcompr with rst $20
    * stubbed INIFNK
    * SNSMAT stores BC, it's only allowed to change AF
    * some missing entries in sub.asm + some stubs
    * fixed SUBROM

2004-12-29 Manuel Bilderbeek <manuel@msxnet.org>
    * Replaced the font with a new font donated by Eric Boon. Thanks a lot!

2004-12-29 Maarten ter Huurne <maarten@treewalker.org>
    * Fixed register trashing by RDSLT and WRSLT.
    * Added enough hacks to make the NMS8250 disk ROM run on top of C-BIOS.
      When debugging our own disk ROM we can now test whether problems we
      encounter are caused by the disk ROM or by the main/sub ROM.

2004-12-29 Albert Beevendorp
    * Changed detection order of NSETRD and NSETWR
      Fixes graphical glitches in 1942
    * Added SCREEN 6
      Fixes graphical glitches in Arkanoid 2 VS modes

2004-12-29 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Select 8x8 sprites before running a ROM. Fixes American Truck.

2004-12-29 Joost Yervante Damad <joost@lumatec.be>
    * add more hooks to hooks.asm and document them
    * add some commented hooks to some subroutines in main.asm
    * implement ISFLIO; with call to H_ISFL in comments
    * implement FORMAT stub; with call to H_FORM in comments
    * stubs for LPTOUT and LPTSTT with commented hooks
    * implemented CNVCHR
    * stubs for PINLIN, INLIN, QINLIN with commented hooks
    * stubs for BREAKX, ISCNTC
    * implemented CKCNTC
    * document GETYPR

2004-12-28 Albert Beevendorp
    * Added clipping to BLTVV and BLTVM

2004-12-28 Joost Yervante Damad <joost@lumatec.be>
    * add documentation to some BIOS calls in video.asm
    * fix TOTEXT

2004-12-28 Albert Beevendorp
    * Implemented BLTVM routine

2004-12-28 Maarten ter Huurne <maarten@treewalker.org>
    * Found (and fixed) real reason for Girly Block startup problem:
      interrupts should be disabled when cartridge init routine is called.
    * Call BEEP if character 7 is printed by CHPUT.
    * Fixed bug in CALLLF: return address was not properly updated.

2004-12-28 Albert Beevendorp
    * Added stubs for SDFSCR, SETSCR and bitblit routines
    * Implemented BLTVV routine
    * Added bitblit related system variables to systemvars.asm
      the bitblit ARG has been renamed to ARG_ due to duplicate names

2004-12-28 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Implemented SETTXT, SETT32 and SETGRP routines.
    * Added an incomplete TOTEXT implementation.

2004-12-26 Maarten ter Huurne <maarten@treewalker.org>
    * Added MUSIC ROM stub, which was made by BiFi and BouKiChi.

2004-12-26 Albert Beevendorp
    * Added compiling of MUSIC-ROM and the DISKROM to the scripts
    * Initial diskrom implemented

2004-12-25 Albert Beevendorp
    * Added CLS routines

2004-12-25 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Fixed CHGMOD to clear only the sprite attribute table instead of
      calling CLRSPR.

2004-12-25 Maarten ter Huurne <maarten@treewalker.org>
    * Added stubs for FNKSB, ERAFNK, DSPFNK and TOTEXT.
    * Added stubs for tape routines and implemented those which can fail to
      fail always (carry flag set).

2004-12-25 Jussi Pitkänen <ccfg@pp.inet.fi>
    * Implemented CALPAT, CALATR and GSPSIZ routines.

2004-12-23 Maarten ter Huurne <maarten@treewalker.org>
    * Workaround for Girly Block startup problem.
    * Released C-BIOS 0.19.

2004-12-22 Maarten ter Huurne <maarten@treewalker.org>
    * Added main rom entry points for INIMLT and GRPPRT.
    * Added sub rom entry points for INITXT, INIT32, INIGRP, INIMLT, CHGCLR
      and WRTVDP.
    * Added stubs for SETTXT, SETT32, SETGRP, SETMLT, CALPAT, CALATR and
      GSPSIZ. Note: the old SETGRP code implemented the wrong interface.
    * Moved GRPPRT stub from "sub.asm" to "video.asm".
    * Implemented SCREEN4.

2004-12-22 Albert Beevendorp
    * Implemented REDCLK and WRTCLK routines
    * fixed minor bug in INIPLT and RSTPLT

2004-12-22 Joost Yervante Damad <joost@lumatec.be>
    * fill in missing systemvars and documentation for systemvars
        - finished, but alot of variables are still undocumented
    * stubbed BEEP, CLS and STRTMS

2004-12-21 Joost Yervante Damad <joost@lumatec.be>
    * order systemvars in systemvars.asm by address

2004-12-21 Albert Beevendorp
    * Implemented INIPLT, RSTPLT and GETPLT routines
    * Added INIPLT to CHGMDP

2004-12-21 Albert Beevendorp
    * Added VRAM save to SETPLT which fixes about all wrong palette issues

2004-12-20 Maarten ter Huurne <maarten@treewalker.org>
    * Implemented CHGSND: writing the 1-bit sound port.
      Fixes samples in Ikari.
    * Implemented SCREEN8.
    * Cleaned up SCREEN5 and SCREEN7 code.
    * Moved VDPSTA from "sub.asm" to "video.asm".

2004-12-20 Joost Yervante Damad <joost@lumatec.be>
    * documentation additions and added 002B and 002C

2004-12-19 Maarten ter Huurne <maarten@treewalker.org>
    * Implemented VDPSTA: VDP status register reading.
      Fixes games that are polling S#2 to see if command finished.
    * Implemented SETPLT: set palette.
      Fixes wrong colours in some games.

2004-12-19 Manuel Bilderbeek <manuel@msxnet.org>
    * Stubbed the functions that were already in the jump table, but only did
      a ret
    * Now also for subrom

2004-12-18 Joost Yervante Damad <joost@lumatec.be>
    * add debian/ directory, provides debian packaging

2004-12-18 Albert Beevendorp
    * fixed a bug in CHGCLR which resulted in a different bordercolor
      in Famicle Parodic.

2004-12-18 Maarten ter Huurne <maarten@treewalker.org>
    * Added support for Pasmo to make.bat/build.bat:
      "make pasmo" selects Pasmo instead of tniASM.
      Patch provided by BouKiChi.
    * Keep Kana LED in off state.
    * Released C-BIOS 0.18.

2004-12-17 Maarten ter Huurne <maarten@treewalker.org>
    * Refactored subslot selection code from "cal_slt" into reusable
      subroutines.
    * Implemented subslot support for RDSLT and WRSLT.
    * Implemented CLRSPR (clear sprites) and also call it when switching
      screen mode.

2004-12-12 Maarten ter Huurne <maarten@treewalker.org>
    * Added "dist" target to Makefile.

2004-12-11 Maarten ter Huurne <maarten@treewalker.org>
    * Added support for Pasmo in the Makefile. You can select an assembler by
      setting "Z80_ASSEMBLER" to "pasmo" or "sjasm".
    * Added graphical logo to splash screen.
      Thanks to Patrick van Arkel (Vampier) for drawing the logo.

2004-12-10 Maarten ter Huurne <maarten@treewalker.org>
    * Made the MSX1 VRAM transfer routines faster.

2004-12-09 Maarten ter Huurne <maarten@treewalker.org>
    * Introduced debug.asm, which contains routines useful for debugging.
    * Added MSX2 routines for reading and writing VRAM.

2004-12-07 Maarten ter Huurne <maarten@treewalker.org>
    * Make CHGMOD routine available from subrom ($00D1).
    * Implemented CHKNEW routine.

2004-12-07 Albert Beevendorp
    * fixed order of memory mapper blocks.
    * Implemented subrom search routine.

2004-12-05 Maarten ter Huurne <maarten@treewalker.org>
    * Implemented searching for expanded slots.
      EXPTBL is now filled correctly.

2004-12-04 Maarten ter Huurne <maarten@treewalker.org>
    * Split off system variable and hook declarations into separate sources.
    * Implemented inter-slot call.
    * Split off hardware related declarations into separate source.
    * Split off video routines into separate source.
    * Started subrom implementation:
      - Implemented SETPAG (only for SCREEN5).
      - Implemented CHGMDP by calling CHGMOD (incomplete).

2004-11-27 Maarten ter Huurne <maarten@treewalker.org>
    * Put C-BIOS code into CVS, with the following changes compared to 0.17:
      - Changed assembly syntax such that MSX-style assemblers like SjASM and
        tniASM accept it.
      - Assemble main ROM file from main source, instead of in two halves.
      - Renamed source files.
      - Added Makefile.
      - Moved change log from main source file to this file.

2003-08-10 BouKiChi
    * fixed clear problem in init_txt, init_txt32.
    * fixed scroll in CHPUT on txt40/graphic1 modes.

2003-06-01 BouKiChi
    * fixed chgmod related. (init_txt, init_txt32 font load added)
    * fixed curs2de, de2curs (screen1 support added)

2003-04-16 BouKiChi
    * divided sound routine from main kernel.

2002-10-02 BouKiChi
    * improved init_sc5.

2002-09-26 BouKiChi
    * fixed keyboard routine.

2002-09-25 BouKiChi
    * rewrite ENASLT.
    * added init_sc7.

2002-09-23 BouKiChi
    * added disk routine.

2002-09-22 BouKiChi
    * fixed init_sc5.

2002-09-19 BouKiChi
    * improved stroke speed of keyboard input.
    * added scroll routines.
    * fixed init_grp.

2002-09-18 BouKiChi
    * added CHPUT routine.
    * rewrite curs2de and de2curs routine again.

2002-09-16 BouKiChi
    * added half of system font.

2002-09-12 BouKiChi
    * initilize from RG8SAV to RG23
    * ENASLT returns state of disable interrupt.

2002-09-11 BouKiChi
    * added print_error function.
    * added ROM searching and fixed usage of EXPTBL.

2002-09-10 BouKiChi
    * improved clearing memory routine.
    * added memory saving trap.

2002-09-08 BouKiChi
    * fixed WRSLT.
    * added keyboard routine.
    * added GTSTCK and GTTRIG.

2002-08-27 BouKiChi
    * added sound mode.
    * syntax adjust for other assemblers.
    * fixed RDPRIM.

2002-08-26 BouKiChi
    * added initialize value of GRP??? and MLT???.
    * re-adjust memory ack function.
    * added calling H.STKE function.
    * re-adjust routines.

2002-08-24 BouKiChi
    * added INITGRP,CHGMOD and sound_init.

2002-08-21 BouKiChi
    * name of this project was changed.

2002-08-20 BouKiChi
    * added initilize table of $fcc2-$fcc4
    * added in_joy and in_trig
    * filesize reduced from 32KB to 16KB.
    * set.bat can be restoring for only 32kb readable emulators.

2002-08-19 BouKiChi
    * added DCOMPR function and adjusted wait.

2002-08-15 BouKiChi
    * improved cartridge knowledge.

2002-08-13 BouKiChi
    * added fonts and key input routine,displayed infomation.

2002-08-09 BouKiChi
    * it's my birthday,this version was playable games.

2002-08-07 BouKiChi
    * start development.

# vim:ts=4:expandtab
